package leetcode.dp;

import java.util.Arrays;
import java.util.stream.Stream;

/**
 * https://leetcode.com/problems/restore-the-array/
 */
public class RestoreTheArray_1416 {


    /**
     * 只在最后取结果时，进行(1e9 + 7)取模，即使dp数组采用long，也有case会使dp元素越界
     * 必须每一步都进行取模；
     * <p>
     * case超时：
     * "6136147421789746411526044109261832612180067308496377171886212543002577010903330926946586311014627521127378269049738294028166946256379767663363685079771330910169895419548280283239038829062140820916898767625774659885750828739780242018088627624419103497417311656852824053782548958411620722236565449137647104079935112353645133748379370019229582446866668988005510610538957953593915230921115525572005156965821347248665996346513155626277756559112323969440649553977416123717471713181173639386447009359974864602204528898290811112222816642862223466509841978079552575745626721510423934856007388938391137241423861355774463750196119111695480966982169723798415775846363262310236212378020402693755882771376457793189276476731421052038938497613362052606285311291032643903016127198007064596646141259778471316543824463609751242365792011242480130235508483924995524877761310214144613624613643313539571556292485183164926690192745084963607054155853987239825999608998999550081037850222651534387399296106704922261991171152966584498611848590059269235680948598818605117107033297804097514143710695797411669883798332197918162235911472644458151113454566420362319265981029079275034925285200166492364281224725039493708819418671803952110586791437553821033248697347408388429676209869577775544074819482159475592865221054995991740383434672618810067045133332190641418091284995402905353872171610149558389324106704466092560010756897509660611147624041331975422329982477274067559146848729709621419253911134099943769134215052211274191975126042818989814764270449466435272943131062894483716868991534306747596105971935422824567240109510543733175716657692829444206925030677143113147843134436008173286959960614587359387754879546748071522051014785011028084814811605465344291081751662045781553527931109093539645658824901705011117510644574836553978956540350555549723985763796371403679460554110463932720085754158263646252225062225983843445847947286594549480737921308762189808699226031651076445216310807173044563606020173615867215363483365211132069262794469617985693201009563071367406058068403249148189688752468926677525920412167819038525232482650442429489082037904351810719225298856496577846964720049931778041188826145370498212687252466640757371649372361940352609689896996616328286121478877715132638971288627274660808794505598763958298774897096039259181691634889377571963349934514229762052817017864658300266495211153201741121939787612158978547342449370931657199590998152881518643815530380234736792236535629580212264607910394868360021101667444790678621016960817732734669088571393965499749998784712782257340851122420206373653893185407175039951109971410308533268269779916041689961396510714086010749634354661286829579997690894867868775564808827919657160834122418983110101875796705046110343212124227155824403990457146191881557598993385199335155505786988921428421306868261987087657941362214614985027861050753840165819774920077235151681291051501577875504459680698106533934719836337675685310049858624993138108686815464797809476547283315563598451036297827280059555592887656406760977687777135532121036720352192935620059948774337110174367515493254042547520855627071890579421405453554272773360164713086245782173849123310166407377964744648329117309274108929646911266611525949761027338377493158144708116525368288883946583640910756072436394428800422715557767881076718189480639509280345302080417458667488844104867211249181432993500422681065245854655514940152746202040533396040857219138712874587847842038102555783733270722549714826958463412829921042661582891763331070281120751411123576042054575074530502744502809701998935776451103099110976873964316501306894245614122419759610180080357608430858641223313383134833141791669305085218394547399889112101657081782052593721065985391346582705418502361051062907514235082540798223443777197271741979890332866144020128161366746975809734212556742075966234779034858141769743405305525473646912894798851598446211145572840819622730736106560879104122609109663971644224187563567240576608269366648045011667170013300480100010883297941844203855481330311064329159534879448095667037769866610244803081872059199065162781739088905890717328431959452116715207221987509900108131555969877077622653142897239780978448769215665233718755716421036974577343231196280486426915942926663632586808319360862945077053969494827817114155395414330010747942842428287255161134682402741587907498037216202662566760083364888673459297228252358550562605553288086610427649257108890567980338241157872735569138518815048263954293028705713771946088540091267102460846131342086539381444860643112543093889730184768731862938369566492571696305980506464444152854223423315206905597703432078067773059979765524187548834355586832453734210515764948034573207267126220216105761135819325821380900523921378106528715191383325239732115764133987116374996083390241958726101303048639810741068928371640179715121099697206624682342694712721184744731110143818882990730937809746711174831294793105364042601955616307485224011122224491191803427428124245739868690712108022886433686154962960481157476101982091235957736962876357384330146241116917875092750132483618866611149797268742803541813142888932377882420781803603749539885662244402789925691594104757823488380511498080845336789743270183149479662375445199121413674366935580221379525353712791214990865730336204101032479263293212289882477433223343292876274862114969291641115797736106470367854265765903244298040758259920444169867452983888310679159641825907017193207002824499077549383365248996925067154388271200111631130571725862017260740821604053844022279807893991032791591117464191406090710890898295035479661652091013293585636437439161480363211258134326250939063639316671113678194585324865639994552387105376950446223176885804839372272100227732110825542486156220625181250543980746268646109997607968551569154460646851260920643722555757274876585293336962316616398619847700101903778489628836595824610788385211098367192523492883884676127936034799660724425445110387951624728106501264435419475598046106114373141331610600303629286124268308406177269124531926871446958507931021365582487795154296667554377254465266298936215110984633928316262565597429676526839039639844163316147699106375737723097324061252702631264386450164511001418081063418111132713837506313348813649301917302869247634228100741688942956147668810721841499402166651051355003574244574369105813741713306693174771856130026615410137387363903147207110767527811156295100148700231323278885295327384026144884139256422290515707694105008911889841820726105289873742201608148582279759733863861815970953064766188522987827830395516110451180717520566018276694579420660877079879108706620105501962230927111099353587056613629180933466496827927925051412345937370319200511296397535113279019110986200846123493459182782228032867358592881087427542304232645933750684296964916152123610387596314042949271683603401376210094535912153294842821466116034355024018406834268654659585709872707537741706241140242378709471216258033668847723170031297606171042627748822437346201567806295126501183478102706941575526672743150484840651157850779472532513859026630310524555863819146995174971479926584683426529431741157124697737132204958811255509040566143297781163100901669934223471902185726132881721640120814737416039123043613829043139640578410313822798089395631122345651299706772528780426541316214438698310843636160731541039991135070094121217271981674723636088100197646544411073844308176373451048319145884307910205010546019719359513463631092166212057103155183873702301728987119696220082123997216432793254210059715910611596710327695459351447445804129984782036347946305695278714648681401190840855620953234558552959013578204503857801541696747164306443735965699941708923688425882809972091553911536687552197534696488602734388432155327062399193930469259367510699909972095217261624052786780056409853105534423107103677356277287390267211150785943241588262587959626208433056552770937149312594801056031088151929801300447539822574991537156702370182176086445746985157783076547208960451815791725050699252773530903573065892676352458882846505743880399840538359885581096652535130413335895658243684157191095992711716050183903530876784403318091326745089691017529644063180655200276041225098862386394776273492268784422011052065009554216116262407102038746334809517427347310077877530659195138512216180736477820518970830338937648207705724953234503769993747580776852988422892581131580242026816483230134136148187385883493954566221715843419373937212541206224210763004259727137508942643719732910259677210512907267249742340187402353584091819183623395010724419910909323026015906868496676966507610562498487449227127387415460743597822650766646227307794433295203737467013828178010623784823127271131251607931460588797090200144344052382348345097859975410945709510045870196118566201592991739431891390110318082910987319451523783656504081036831552870544883868353778334726238822424517023524567860654348552212572269545316506666993615350875790337325271109374733744744128118958200133076112783544494672301420179960871094184229504597965101825396047028719016736555397837167537593535350487313831088354091086464816430635361079637877063754645498212958887621510453111811196048888059607631912671030027344187107228038786034881819712853110655235809353455140316761980795800113100957258547771112507436428686155980418029275792176318026794250410590994010620401832779353907557112003335195096341100382535105975465174145769203149815312734938743915197690774197797577873071041239194644737799012445711977815546911124094513645948179283410843609518882514982187689396421169181029210233331124968361837333966087785364236307196632817857633105953785139623429665999356005981806991554536513711167193363384207409358881766941901134291353667896465081749129805369546530715920541444751021436145385456810588783979747269480907623240159541311352694252323370455337265581006142411616737381913227982030552003313682485015494518588638014710221763240329990974077392428440191166774344423006052088638496607180889167227618414114430708508724184562885078360112744755343692888836223879349119301215135417034594736809788916981106360544474320169642130778511681099244174975769893083053685357424454066242764524493631344467475369636761714614889537817109885732191314641281817419935984357538163314986315418040617766335232399592408561716799986782838355844079279944517111412005417450021613507827410160339734289140868721495763736563575013905675648466406636030591057323364472311843290458216428348153891284982479440592343727101827648422665787353989372567867215102988928653872383544272310689650566796202220824156489280589543953314805975278329832477523224173672756838130823405093599877735294110424285799857504937527591380002701188481004102106863714475573900721275263593195328922992429331028996364365894342777606111250297550531136112749196146543043412217710802245410776049610365537817482254295290957225568354242292101146991763072971101937236137081676462986103184812196483979273431973567304410940302920585119212320524660936306475129931196641830177120672471130465226206514013021013460168327347178367454999804939989034292028281913579445746658417013589901320827250262631646437304843643534817856678088080033668319529232748007524703195415868110642418650235358194195258572786100872741541919941122932333180471417721909285137410607658197894142176816643060312580398162879361598247402867454159266787118170549903300158076583247781315579832812653937235290815238204784014564690514864897890129513499277127351107858339094124081774319542784751051172181958205049520678171531542954052668807198815227931051748979293040461741269101718852268734454956960437201995532771510657055446271991893256499326421380395985901211697602119748703027623881121321675880235931013373213822776388464397847020569140358014331849986861971041728805585235944661246525960721597527318864518704789755919096199540688850899892907100476190481091081443662139864346033235479948011787320974128632060713783503196625271483872543704635543490161505706985074773025764571730232545262910365780124026941279874062445939174638433886841519666455889809897107693577483105561350184149723681095046672953382330454807445425044748569921919767103738268936373855999566721930385533418205316718637757214737721969101303370553508871481171102170102981860767853485500122828991686368694672731639672903120611067347661361426577058581118384589540991566832807219447078925847349759564112940591058153652510585853235922491691625397621122628721753468530686756959837953036133577225623104864134101845928591991209879922760888345558743398005308260942768866431909257508174110061475821723118100534778507551436378615328652407800656478410214614791816702225329439958741665361081498588199214712578126212873239138083457472107188776893556741100538811355399756658987595380104774134670648747768807577805385984020617726152129173948102257495469992318940210573809483111744202014994998622227492869397677704227829844357252975529190910085229823480346323226411037883544139026718884761901334366624327622102069803690801110794374828485469798207240807838560162616348660100816434560124885467422210881635310237471169098190537017133227915417028510474903931050644546165506341662145155713731408125286039222106051413592589114592194794297573809323739032090229987333106303342230302435349048665619861108421275675738217620680129853916292729560688981663984779850591923662152379756731291688056685959680875167823110141958281068660934817564521287320657444463007325273606576017467201610481593210992150110690889467544161437171599656434198252514936068225172607519088347515785234847805211063843623912841674669610358791791575366109668030990688255525004896056904355591733924697102906409041619959166987387511264834028443264593398678595740853210047649823441145981073918126002783469426918077937939454657156853773968894327708690866928054972610872103986060698414001107927980177172405004170354671959431329203326789910579221038796584105954938881986689491317538707361477873142630891843613601875552155017856250590081001961180375724503887140915373162364361259061310334722676132896682107073602520521248873102854956787355448695686105100746957703902695618721262233760075963806356508614349673493816701475298595011648641267447295576756874117558863276371800438142414111386354628765156502836522679323663049782742634287294689201398922236567950902674780176718684662280648311122883133202228103650404341729005900680961608234755776878107455310039018741298514112304542779984610321083998279388987936908782724147736278287095911138718610355717997632735164379835425359184750813101379263440271014981712968839954113025764151914927848744363172231497365374857544565201534401194387850164110301676214678054848776302716403814002510792847312207197410989878510620528310527749764013073338077957569819920873874175186561192270484474748338141019826450147163508694218226543439783990004425355306778591086445637394361316614898510760885440699990503383712821139116451043423992235532965429897671864334138052175783815434798241085416024097537612230309377095938580689104828298107680849566039343449988415101328464841697666068010821693380147438883877251029193802238368384070688190919354958146446390132264653999952541057037748852774885147002524654060638554102268760112716422199884457788506511225519949635212556964184383012535387276483318315958075210722004410913093137957762480820891100922496546825353246012984026771130870803647216994471353101587402255994314094770739400731886751531183300911126337448190076882205752824171862537769833420763418175148054505706137061654494484670077296450371040468811862523016739461499957729969136884620627539079796759242037543900414811451101635712069855950141952758378778768466344188151125824877540436884217744517898242055606544140261061530578557865458787732159160836422729636890466525283651985011228670678505259218016881836695045896355653736026286281252657620728239016445652675106508106154768268956078870961128936484349979715202146591964901456430832825713853268794445785694988567965468345502334361834096110309597694549515119008192362519684343967343903393108168272836589272639963506919592651783570059153105810158782910230003105116129500840062116902065867196478413059872791715445822474106910563464549322723141216084404485643232876226530120068828075184573966692729125541083107796700465529799468927689897255351104535805854968711170924747041692398213718547432129987997564179633607310910588411236794150105896199702475732292803340175726905606699397628910017623883756790424067078738749164689811475438602664575616445528316291794946349810596294119341707418751348130045628233544796307340287387679919877588536095102127323233811258325523290950820643389328644252891290081854593061091349983575074581081797614318828346808923974989063641674713510923337119832946663511602832967668771103834091126447919200446157591905400320095788673320324564384707577163603866191742783730293256974965596137357011442624998597150544886376783263010312974957339321895217411165036172877444104330416034013637044652399017508208922773909810545725422140030026813531980912451001622021293150610979638948406958971369159198144845308822898389164578114593973159526667194074848048752236297085284020819104884075340585409201906724664027077021608957191624102949152802505203576686609143879974543301264393886137545916268436444035502674251246155378576730988952121261464031401127314570117142530961209926131827226023763982436874387344270237647812146530152521627579075203155049685368680764471726031103159214000313617778809101286574443177444149313326134421093969979242987910467518074028622964780359018062869849749801492525001587592142528113160810424309569868991175986842075871284718865257660312210282149586391635574946134350543617636656063832432942410093629016060583128935566406332968196646660509044349990684214608296660748753676458612069935959538281151868995308409200428809301106610304733848684088611382151328335512243679896862146289931842703770951919847833951366804346481975048126780506446021160159898806663955271104764828708970854413564304151234225224421849551759779686126430570383525468365237782093606283315071840265082210817253674510444829674876655494403587750139220421391952565290534269664341298970859268351392342069490830558748971441087198241726701185935658657934271725154899135165083983104015869258938554472882759591596229197900886182530617913065426846335195280981910457016350887605372972482222848726058645328594008367366148201977846511911010381368833507341464008261901049388014575200189505727845753028132046109385196682327085362549636934108297675940674490864780937873095325741329646911373100315622721124030813440452953423006446565499076871941016567418331404045203080449795336793277385511424382010393724580822294101710005416925843110788429244120613896321947998436794856290285749409711217540707158175399991870062108855158737773942367166108803341047315331065749538905870220474895774947849432157580731981087874591250661852209769692436783129551424711765463245833755124234556839602313614153465061931787192381060752534432542667502365654511583221678456878896912426051083376194546996725052473105415212751722207663509120608226352893933685921095195057640746524158256098433357997619969864876203529111323015046001127450209317076751245591497150502956062162677723011996881034755302130211953889315244960216848398168975164051063168252811027039316419678230439909332640897624859299333899454961124419143929053043418405616935296574917968060719643726716615139658148737993806352354809672455544943269535504704346509007446291523418160844734086464960096703959838111548168060005576539912156928119790377516302619425866961824341310301106095733285969972001550868692315101686042429687664187936754787608106554088204437611074368716457468484065292349769892824899385126331151873584749274320118542123658102591252705641021244236442754783023667454615310174331376767983712071257760153149326624613024512862254048194414619243603854103844056130410508608687682724387118293394194986540818380112745083807797750722102432498372360419085297836202871119670471089718024350982613239128701390379804276473173932224281811022531535969650818072342549911427615160941053507530045844268960458880985379692692086601331454753141827610325455423411611077313247997896615879654945366032852027034477829554711078926903442065174578055713161789114895469129401141318456294235348875038929430315151081087519741072149787205199542180754045181483281295277276129169573136561172307745032158787439385441929406597410344048215419051279520666698341450660657638147186766812785092487445218091073906913257149062311544074959736387863735832468112670529987824792507259412557010551928296645891854160558861790850130236929838294485152993177741042809369062823605229910133163846931645094226383328742790921771676633635365119139537514109841748168642700799249406725241658272115955301243920990069781622138012244080963005442103540737455851312818393103529541144369409006457176349340303939338021636921951269684288341939698904821708393447789993752401392181511977441222445265438684233642459402540481700544251178468011644392418376673313316529796076409694229212810787962248762842282954598174740070634452434948997648538865181031565105209522442964257971230608276512055414566780378492005936159895862895707527149341572452110969998150563341082884049922803155282196112702712169022121085909484202925376410021492017276648468374456702368363588540614859117975793466610370992539414182146665099877707868569729245958320171314219510353575638104231945364693457673908314904395425460614058622797304944349889604504454567986756881413643677707769393677147649222876533972223538710189061121934309856662729196811700306108277450110099820222347511015189011206025655329701088469176263210259380038393144895165408936259085801992084679134110206005880563702070324513858192580601579825692296103359598125744349291923540433278427211087920970465089654710578121394232958904179878554439836926356090486539794538085450330310042225010125085890528949618349360026395874287451605017391508671085777235036323477012460307931565117711488012191450549062301445836722599930092125359873284019908307880457861875929524529999844274958727432485911033380631929075554190971306250103063598380161617971972980118812654548203484139891092428566803511143233350680612660701019892326027852394966503303471991589367169668618959780985989869440297841296867876207532733960982286406006362534515660341745841386104562122113144410397983253181196292620564730581343938287009452639089646832336676119143996593185476277951067764429821631037283342854261797156713332733803166489028366064953851909258943686095792994091303777911089279961110266009425547339939328373830904291374436317787469186886040058846642711244600699004857656438988725313892471594989097450377057638428172166188166549969282555491003538402329017474818498879443045292610655018211081123586908627603722973854514913157011363379453805723192631990487967631009101989797947229774522256746362934975113592053069736785055731102921973512805694160425853899325420618985118080274407883229611912772351629812254928182121114342520929262858733895381313750366782643363890082680889643714641153897752064186942164394652825822454127867883072251012118406136734501975619517210164034634901125181088355662775665736078737041638766955614818848505664609636252374808004625456417891497857920959169141863796216570881098574855181461740231488007177389557721212105065821387846624376519628446825190708461567347943945728924937944128642257384924402274654111182014803105915640239021351361842310604661973997200123259218452624375942498234982850999757864737318198813151627036028032822958336136205445443372026506099846151752406688996523250939154733330461985203015977988382585386529385373104621570321980318212903638703545532606339789874011194133133097661446721644298542288915606875993629120210675241376307005984356919743073665379803124652252997321659652295341994663752717910679790780733151158194439692782594574795786849861384247698760933739551646725626711065741083531212144578341406620257343459908742910122772744742618503787562069270350690490112525267475748244793134054228276553389905449856469763702130879202218319437408669951613297809937958164710451092718907589089101610579528898159262580997057655325695607029107325657612276908883744227354912248116908981109874296077132940953749972113080411184061041345764304078771695832167721042102036660597801326841582060066660894090713670876946550802448502491059718347943100154748387620640002727769914478528921586141085944799861097523923716062541283310023503644349812362893635725143441826090681259893076012183591722561067923244982325940828876888622437763871011316170886691925579197407978916052813742253784307537576076397432121882624484637429823746241938118615550610197846711171569917355867120842183893715323563167703200553050906683870791341548700631785599300262432471114745581932489978851523112840033125028374727391155045889483888185683003863320396860947336823967854967810748845966711796652835100635105279119133635897482100088989666283026215336310315493573274138493145934565325712401555695725189655502210739061068472909171920782089969461916316982181709111926388156879640600731934233431990424793658957389986887165309012072540289498773325684483998199392644624138704331141910008216214847297112415746383126081133118958027323111696368879870813219777928273124039552263194886765593390678179156410184308208683280546226580542982309385875052069034108361710398665449753568056309174874652363953809842152418412894125032520795497020973085421990895655506817884021910185583629548026112571433578548142153560122862129267354342528223096992891231782821018871060871006352848710476354610451640199142618967169087656809113155770296678658905423605310411118744994525444335031064316547592231943169678763064252356156952781954317037136414598137301843494213891621796574244700015831818272111306513881193516485936597125197051274477357459823258107273350491191174396991784545475374415967319236910408144411844022858835424400850311160420121546796102296622656252181430652195037654371623310525471792259950798681260488353823529998980506868693157903949105201476845642470042646807700506463235287443637844234194417473147363104625138106175351825769591090685811104648090190189442261478320915195382512455061892397454861565618698876483434171299034279749947920597955911316653422930779457503825790521161022817874426274744281490958396572968038720720796987208288951807539726932844188608298032240824139655215181696523666506826941454748229610631121289584365000110851923819623877823063073630237972924410666955318610603628935389899415234135296827433588657038168349061418555462608979778947274596834563416570847114000363957751276045458887353504539931526261539754719885302347245587509874462077847594012148210013199464931107108502275360246061077881672478242996575924639661933105713110281644313820321048671235895849938909811609323130816775332327781399326110770827119884748112513572104437566517832664042850540403665172904742557799149167342084497733486958108795620116488052017178393291503319411795003035411519667844494796299110570058092271304483072916204675292618609719056125200935256595147526464782948797136820881128872757535228873946852410771618866996101746502108135547759897163886623310356008461697107254261815088929996984251028261181101404955716228123592721264687349273873125965842332182128360847396433346989778424601845684719932370970333711973105281114819367813564669356837418454157916173106626123616460395445134190263114947023497916910210265539625741233426463147462396891691054161651116166397661578730029155430539257044932479283498119514516589701880493493358150667710193259597506549358749393364606650131059194082584299143818248018853859895663911318245131602373920409629806767283924643607524973498577890133803374274162122952595311070168093868530108275659351916517164226999066913822010110659971408045757385825149074384415075709140812354312789124277406935756780240236684702111092940046086446703218230147007861468288731014075449872851571139182103530559108007887108003036493140810753561110919901997505091125373411023982238521188324122421109461104314073464856280141529794108120452827098805733479748677883600459576557399525432667658561110466018474014278717325221036445849828438573047352713688561092014942392541284160296877925315337373637694955260989415170770267268564339892006941863015993215160781876509460553043217772510663321496374721959307255936293314526520427414725086880283232942650927818651298951774627109997144777889774971034016083978960383924819798530930353693302173439956979113122737733621864565111231535768509459248248115083878620785162385919991771767491157656699016465362522498521080878545653555793574441101308433630058910207357411326890239528822106639834683381879525918371213989120231891020321569978455910938133419855506196818507937913962931842158486596628053921135127503022782384609861123987615992347794515611191310110919877791257664311836189983776869185713100736200709957948343857594360654309685147740366910693535381302534296761821791930959295456787747559261841101742672621271861124378702230680456378696465624768423593784030848626866877294225201516175623279103820346973995031015729471683556172526132372010047224465463199721184512464580097863746416919167500521508120114851683401346014945727210486013421788425197738399878664503088795044799375078893326271101088531031168977540894559228964106847494825329788849132255745041126295801105195013067243099232375362615896208225343984641000072953855748752231501177805583200291626068813344226672668451942421761196938694132881918549960100334875951403548391773621110893781851222787929359046867941526409617432876560010631716222437139180652782218633603543654173788943154409438309108231023880436632763464520423311494941367984410936930854103464684307876693440844910174571846654256835272226524715050422407651373776631726687701498782031336380695598793035717775640575364405965027102678752027494477075159853407229794710372971039129002016732236139882611613105030999955484298255227162849981113240908192118994961522373448815446937847685524157373422253788870207313109793240103202949976102743348369584821296745246251101403108532324829539639604169651921348663251881425659149567767039992536239726757513103193523454873356562775096234110322902357616199198877335262453741210060520961685728905459412557688038202410141571217900860634527807404611228574048961914350262111057099449537101485543738594625131141028707707321131960238684291315186971323951068888977311314864591289886889139618469595135013807894739641359958565282204628283402735818938343559483950694527106545186807420935244477729705692753032855575854410010206185286888967433423229461353595884021877615467871918233619540050589858587230461260802260406203278048306457359587422328480877969112020861671702373592081063922322745583691782007395730388865337604047613844122211092909463942361790629008031367669798331949600950594005684285782488266284988485127700116680101106581070374332096173731729303316432748275090513532457959449979914921141314142213893682821041072099794611666869205407069971238276480342660786564527100608068525504487211284351565496751183344952310249648926289453815225316947610241281068012882645778694802255570125133805114955001461069686489307228698019802523302510929062422368342565666894360309570128374207224560342464712211563553902048105614867410164172712711013737632700213539090742213812578369223652034704132168240809784109876012428022761026245141086081261082217257715708961626348973459643931303838432691268211510345623532616629584264311930912714814215785156518548391022254061952777158178715636854916104201263877541832480075150633279149000802604401129259151140791010333252638127491749925327943394166787527270798810962891833876821784287683557907745610884534936571051782916975003857852104838179091091148544179675885355876515432026965887321239866570883032452590114900165299248842924960351267682033092772867807393443368226617472381525433620926034412099111964901510037195420769687320987743266722967835873009418682284752621911028813595820484972491798160519340953618610086056043396797122404716217786382356489994118243542881389580916748152173371902209114511446635023955479540610870210094571360637727527372857909328917007809737276260797142197292696955256178283138336957882983867974356038574715035653471109932769471230582449106611632486284971195382730054311093717738992526964746947973477291516388987142868969645120718918533776152778761761901060385831113006281760812167464643109516011177408327118841087070368492663415807867587230426729338535842024058281810918027448395882449149517758142954302744704069556554967458245789875434303754552685461987170667881944031424264716529177470381498604105278354548820345079470866976202583810898370782465724736770062345396061792423533441360465999483485923284343498270253345393830354648190338859863080267920736847270277194742404210704742032891628107746366109497199104110898165535253018498577278992785363841571348513391930471022559487957445221032988178965829623024917795838934881125747463305773514589836694479516215137331354754407868961128368922171487699383477933191930984914102057636712759484250758498889551995164116137600449434302208261009853117337740817967857871526194057100192764803635080756389244396850282419687206593520551205603698641626797681098404185416418269806742866407382791488691032947655418229247971248057019138079867252553309956195576488621249637120037896405466485557797376750589255817530090828209341574456128195350852036933274722371226980937270472407831190144690496237513376448703770329957918911127405568467103961432088711910065719029463956842421608910500904324757710859706039460061543221593859699213339625710175613843111435329522880385487865867305331870041015518539925444533798421979848330965412973802820447166968333234975536614107939584090416137219267619695869496081949627658482687382469781080826125579381013079144158010736700259709337696375979437514193010676655860936166069006010589611001286352887789376751475358879590907986481821122388305889268976580969481611225757718165941711320918222399201859828723666467360200423998552548556984964200334878891103479096477373833304551717100694159431012231845683538937348998481108815108424355610839639667375860528317031024050706204899324383020103746848827820793103233110238378084505910838135671835206536379523543634580585276103320259744539978693528739237863949325437688820414272097908406421091603281037414401119152271048738751098226721477089791423192796986409292124459556362471257554317385640161484228632705314042139785758445089331794564911404932508708721470638108706989404253653725319950642508106571687202697847515344683421852993665122485979340480698415254343227442842585472727502295611479746237448070472126050496939071929572277473100939419500481017592188892943837844221100053175111207830109245540307347235913129663456134172906851116739451956352121695894563616397800006125279170125455424303578314784727327196071913501170442734114552558494443694831801838415104573523287871899278659482720126836650222148759001529650632853895107353829576008258910681016914497272106342893035231285981745783732517436773602704112407201734715928524275295877594795032501941902663561174110809034333823078403524976405712336307684665876864376237958267422794744702859528085750055118105494814954024061869616476512943620013689655454707714039991117372397938749941123887536438835582867829229639590050213355932503665005440045760724303685436711618257631486139381941226320829094123244259094674598786088913772428462988745629347145838977800723634092950967640096512667135161092916673166110058055935830859660855573815557491912758285849104138461004523893588409790324724110601368374209351041705654624833127512400753054282693320066151079252833923396516411217322857976429653690817316172165096737425179010283224113069267108090472221215318122194667030721617943467408583311630681107388683575764237140941103611665924004407024239628320924346440278892115648802627916919761120844735509314417629324100068967393300466648622410394615543684072111389632564950652060874471443993995446287220006033866552341618981508193024733653717174705770573664115104655686358307874270094019116259530638009622711711612082102786794068383524517394516062820573884503843206771584217434021777646456621207239595385832111326594563239349024862138924968022260042415989933619500443365192948716404065263781400193748143688580686718531024954406710149480087565290146412676670079624472485672346687872461103968561195956840339271011665401115114807691434370071938588502951038001504873633141359354683087097692207084990926397833296718564720284842226199322499053397890713465904860895997399174236749768611152552060574252483578674837137932659314901036469124624622233110883942466149073112339689104237080133141613237032986564559065330321474261105111410583653639739939167429763393117057799359238491252235569910731771934816571109730031753968934533287884955881549903937687581826891137207977829028710870841491047911499874363793303565765060261905716811630992126768789222756677482784349491627340687811178102527973002213347345557817226351648195829210815846810236206952587352950666112841666911070442350049705788025626148670605793201022684859099106103800517378127368332789924331110534129607067894772798832815130747237046790809764201086308581019455500580580495705320814027173566463131468512606256658462199396935903120469242366315497773728999433221543385938785940888545330310237734489792090686466011337751208202503665545310810495743151426086436142955787826768276806470410225699216538243652681839594291837016833319204797456061726672090757518201128147111099183244417623617955913866344511104671090681279063207411413022151043301086496893328325710278111672930467353404077242732929279465106342265665355818609018541093771251963072022851737810752573424929166253399883563519893703998486808884389584959813753719131077729606676478905304530714772785408997623893396561407568521067300025692099583011501034022509749188758635229101867437882047080425259755687928625268752838918494564251104962492269483219347231137526468392164260673899953562854288770311296859499704829307140872467908669271933987383481031136149143764038734373280741147398514424351891949510401322465317687113079375191054031124661839064902784632441688413995717607582897259421461821762292065771554317419397949821641584767233250212488556624457066231635646522984180414406101657734545976674567020468828468185213341100886979758305811020262597162000110028019633448841117824718489845466908723896914799442217450322211981747433614031104827336342029284681676826474542119206704274710016566886292784494834102210853349608445034192925444078258156705741990142710242088172907969711250731502496447530212789754107955433102240263939227621257182719176400338502678667849074553199108822503200493244118155113370566354046004115440413756126143017105374329392065333223685199617981150408449378122927005875592429839981290630785031165036190939932768581770854256385247266653682488909764669531013211314643857158361278839403222613741221397707047659977166308939579342910231236213652134127904426730568172268166470328422747188504079798370297748688144932746555764744872864318456109225744708039289475045352564993691560639419037836131703213210861157220111292679828970318384024563562933631151856413331952730668239414956717587732155452457045101091887699405443950818793374864746065701334396008814955621984617190095641971767933909667394537674755042551284347816819782327091016908131051876534201957995746555167386417996257300995606039052292329019106498065182487412156114943711645778450004393242611226368161960842391787192980914594262931151330688096241923525864202713767677999911113833784390738069662741311095306256208015341068548341032415089853651693938977951902364800552413003842400092152736351712656800126733428251218149635080214374802944449355489927101994819107075491042217951570985658968836246988387699542676456130981149001035017407744533676315575369074556698682510945809860108927508419017663578410983076800638815756719813748631576185187045967777898468708223757450840952306391062028629847290498884400012919477463916699082206463403102930828386528220506114187829026069026469476557129496611303077010411161250185351061503908441740021743611106466729948400910863763771689233514271974721190835278166637329827120527419728329482886520935959033650612544894080847442023547207416063368133164083610163132546453232140857984678494429281303453245808883862787587189760569078895046161480314556558095414483233947615590961842853318752531624380178278450231095436084022132838601312107097166316191111030817668486811085063699445428105371199976074478288712541767078105723421103199794235864104024111897755686144485695562874725737854868071330097975546781044167429128083475703951243516323284476911990824309195945475461858257443588746591561235736756993832647610825637875499611929956798945049160451003243936981051061069373558792344025432776442277024662785599778084752405633300894258737446160036950537192518235294995682939190346711498628189932792646597390621315709124796465910181512937194465834928188597593908955654868989966512061004224083788810064636292474719165540702858020171103207266746500519492412922857457489295489322379577702168225796653251422859630191840833950587156251088621630197933067953715895742569219998145191970248366106972037636674681885697015194297855347195271624045563415768068785487430969125358762148606013314835060592809152443145814350976943380106241968001852117559513380610177479612058978109315449644742302657483377865550034794487380779326020448423078829039065842736310871795879155425581033998297696758961541331230856954465531033141087978141128038646244816995946633687214849972566478222922301035631140857517971867299274308684973938409296372833804410713298201684554303682157710129084100048196908996802943903698310743724677219350037111643800590747213376195925177182719758918150072377227842105324474708978703414389065816706974924442538009226413367165748261495253443286832911895152254953173127119882475405526611979928696829741901633717440890998168808992791328717440183105513447102033141110679636560432282408062558510139768579975567650342133170270325124663655850826955594445717330586611036650229648659782101893576684790120435344243749809475177212743627291321524263070726071263615389319629094604523589782070287293737242589389868101159902169244323359407356798040109502737954374848126512961277103923750701875944442476507221535544869247868734756127858113309291856936725404104080815289979757920934197297485436725374464184603112535727210596142908752237910605116596259056247918265443429692369356133931751125763389083086647596733236927765211127618559616442873327063636052998445073774789346566648162046401341338767727160922481834256573545893462819921818926162529831783727304224074072966957299073855241029286587521958826288951379730712668233143319812737753820792354371475441095796178163991890353356342010925839226525196151208779429493380225272428425333989443213062058153985820374317363624914162366374503219887273360388950773775855444367262284667535568360267601864164937915735946256772183997305713216648872279385842313083410995401711190500860232700645551793684261054441875678149569370285511075231083289101462127243298064751922172061877180130666573907844514610837233910870100761878688344537871226233549232080681696235861324366002946850782925793616119321640196209814928093531382131283738455426944926367388845579821884546987656977697203189166730521393720073035070667150399335680968241044256668088061955703469646711538283248310849313472384903100336552978707730554919714776189143590021148112950255622116146284592210415107172457269710644440741213034267812346788455768070139075966410085308748711654100042386606718364544801349052920846025567979888577948615298160979554463418902799588328331382841421334561848983590543038078795524371133492820921472863351500580273043389412233427853269109197259502019502787249298228083294699920247109756110311465677770205916045293778671703232344271401403110556677378364358396168026968542112912410823921100731629634278617630102621981567368706135444185118994711267565987696432942859481497641699465146694698433782913395072728506055972275449672657478567654953715131277066985232746899465116857756546471430157893668426101771902102837712781295101082153235571720869194626932250791808797415831912687520018120151213412141027231979205237551899472585289537026750727966913999726771263754532192308102090337484124444340911037817863411837910387387059702741401903184115312898183227176293628391012740737998074417973981572686916205481899767642383280750422531705010230487545886832432376988441536723519732611423048129912033509075579372012652274915369580563015057095176944537576942906514853201792120179922998856099558648478628512452710266189111223048982995821075556955437896792915899345822887395614322228303347332887186129565154535206127519721832963747549031460275110501009704314419405513020581372695981046597596220662541310475112163054265430367803989170083191376061442171985253550276440230145867766138679165926287334171133112012367913446956119606103934256667726106657562010458731466555896117390915265456454640586849888710023793677702307130801461925445784439187443847707475031810005346622615536275983255121931883331895846622289853212858735291092084085299009838012556403838684064743947813591730812951470728202082138904491754200761916686164037931074684841004060606526282896249713908687420495180449323384857166010873795024604141104750215213894125844514036727408306002768298714396907507568348351038594072210005184334026167221726494731738887995395588271036368024340338165138923203623897461152783868849273696521671218511023364930864955106861064112016705101621287158488591092897213289171577853022901605406777219510070967950050833109143503640484645534319373365461023050851100689498519790696177667870543228823771165746739542383351075393171204866616896326199768804356371896879624958831868834413391013239985863277425456431874849021762624001827102508648587931103031338223386539583559100457418250008991010356467379437537499966777886548392894411295697481318597146368997253502664766810652978651058060574764863829034252595542031099729794822238998997875162729356808895619369804142441274948314920387795104858662138883491127607169673078119640655101017319106645741111462790690989334911535630258935599996494928203460006799421715113352692536662181400011625426538156420581530607461235028554237453162579437846399461853617798151112021656051278825158524902717881039438802557808729136834656657294431134973147038117910765665199913412253078223144103085103685730925093890107694028560102676733094318031860310903630059053918273956122057161110484305775770992154237774460311767127251749787526511623441852989318073165233382339656451015521735958734227695688684942840498762441815719625505791628407205887206686526125223908194707575673253332199202862771349718211099749690543101539285105611324506847919666116551107852304115293343234865521094490575036712584701459508510291495780867047511573327157538355528339886651708134019616811914492308043936727952446777311122941296319611340610513534332326882503902372011126907749020587165022127981452924967174189813698227146597742360853075516904812924719048054232011110453626018061561531504023106153740132664444691024410951059516201020714781356208568945897745397357320493178401705383666581053264044914628389713340919671176972353744318437240522171046508877969387573760417843682431651001868669293121616728218659747638457338512856144510961629114264523353055073108681290606535741040870039085147758389883184223745809162104347183679333217232733838225158627886935071601010063687337886572110843054956661299316673145080766941884351561192086492330987842027378151238311624969476531069529188024998729930656102802673506120425935980267065001131330372368421721072662156897743952031766893984404134556990979621865214972493107999690961290378725641178377074914972076227720631030508241865988861885102301396398760503264676571094950218296677124531228747984923874253632555464347559357167210103035271019968605459099913458640244121"
     * 113369872
     * <p>
     * 时间复杂度：O(n*K) 每次需要往前找K位的兄弟,K= k是几位数
     * 优化：通过划窗 卡住长度为K的区间；
     *
     * @param s
     * @param k
     * @return
     */
    public static int numberOfArrays0(String s, int k) {

        char[] chars = s.toCharArray();


        int[] arr = new int[chars.length];
        for (int i = 0; i < chars.length; i++) {
            arr[i] = chars[i] - '0';
        }

        long[] dp = new long[chars.length];


        for (int i = 0; i < dp.length; i++) {
            // 自己为政
            if (arr[i] >= 1 && arr[i] <= k) {
                if (i == 0) {
                    dp[i] += 1;
                    continue;
                } else {
                    dp[i] += dp[i - 1];
                }
            }


            // 拉拢前面的兄弟；i位置是自己，一直往前
            long sum = arr[i];
            long pow = 10;
            for (int j = i - 1; j >= 0; j--) {
                sum += arr[j] * pow;
                pow *= 10;
                if (arr[j] == 0) continue;
                if (sum >= 1 && sum <= k) dp[i] += (j - 1 >= 0 ? dp[j - 1] : 1);
            }
            dp[i] %= (1e9 + 7);
        }

        System.out.println(Arrays.toString(dp));

        return (int) dp[dp.length - 1];
    }


    /**
     * https://leetcode.com/problems/restore-the-array/discuss/587726/Java-DP-(bottom-up)-16-line-solution-2x100-O(n-log-k)-time-O(n)-space-with-simple-explanation
     *
     * @param s
     * @param k
     * @return
     */
    public static int numberOfArrays(String s, int k) {

        int len = Math.min(String.valueOf(k).length(), String.valueOf(Integer.MAX_VALUE).length());
        long[] dp = new long[s.length() + 1];
        dp[0] = 1;
        for (int i = 1; i < dp.length; i++) {
            for (int j = i - 1; j >= 0 && i - j <= len; j--) {
                if (s.charAt(j) == '0') continue;
                long n = Long.parseLong(s.substring(j, i));
                if (n > k) break;
                dp[i] += dp[j];
                dp[i] %= (1e9 + 7);
            }
        }
        return (int) dp[dp.length - 1];
    }


    public static void main(String[] args) {
        System.out.println(numberOfArrays("1234567890", 90));
        System.out.println(numberOfArrays("9012390", 90));
        System.out.println(numberOfArrays("1000", 10));
        System.out.println(numberOfArrays("600342244431311113256628376226052681059918526204", 703));
        System.out.println(numberOfArrays("29332377127524136126230870622335669657843168529455118482387145131383156269464392206602503504142", 818));
    }
}
